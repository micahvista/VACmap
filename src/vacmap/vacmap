'''   
 * @Title: MAMnet 
 * @author: Ding Hongyu
 * @date: 12 6 2023
 * @version V1.0.0
'''
import sys
import os
import edlib

import pandas as pd
import pysam
import pysam
import numpy as np
import heapq
from numba import njit, jit

from Bio import SeqIO

import time 

from numba.typed import Dict
from numba.typed import List
import matplotlib.pyplot as plt
import copy
from Bio.Seq import Seq
import re

from cigar import Cigar
from io import StringIO
import multiprocessing
import os
import vacmap_index as mp
import gzip
testseq = 'AATTTTCTGCTTAGTTTTGTTGTTGCATCTTCAAACAGCAGCGTTTGGCCGCAGAGCATGGCAAGTGCTTAAGAGAAGACGGAAAAGCGTTCCATGTGTGCGTGGAGGAACAGGAGCGGAAGCGGTTCTGGGATGGCCATCATGTAGGGGGGCGGGACCCTGAAGAAGCACGGAGCCTTTGTAGGGAGGCCTCAGCAAGGCACCCCTGAGAGAGGACGGCCCAGCGTTGACTCCCAGTTGAGGACAGTTATGCAGATTCCAGGCTGCATAAGCTCCATGGTGGCCTAGCTGCGTTACCCATGCCTGCGTCCTGGCGCCTCACTTGCAAACTCAGCCACATCAGCGCGGGAAGCAGGAGGGGGAGCACCTCGCAGAGCGGCAGGATATTTCAGGAGAGAGTAAAGAGAGAAGGCAGGGGAGGGAGGAGAGACCACAATCAACGTAACTTTCTATTTACAGTAAATGGTTATAGTTGTTCTTTATTGTTAGTTAGTGTTAACCTCTTCCTCGTGCCTGACCTGTGAATTAAACTTAGATCATCCCCCGGCTGTGTATTGAGAAAAAACAGTTATAGCAGACGATGTGGGTACTGGCCTATGGGCTGTCTAGCACCCACTGGGGGTCTTGGCACCTATCCTCCAGGATTGGGGGCTGCTGTGTATCAAAAACACGGCGAATGTTATTCAGTGTAAGGGAATAAAATGCTGACATAGGCTATGACATGATGCACCCTCGAGGACATTCTGGCTCAGTGAAGTCAGCCGTCAGAAAGGACAAAAAAAATTCCGTGGAATTCCACTTACAGGAGGTCCCATTAGAGCTGTCAAATCCAAAAGAGATGGGAAGGCGAAGGGTGGGTGCCTGGGGCTTGGGGGAGGGGACAGCGGAGTGCATTGTTTAATGGGGTGCAGAGGTCAGGTGGGAAGAAGAAGCGTTCTGGCGGTAGATGGTGGTGACGGCTGCACACCAAGCTGAAATATGCGCCCAGTTGCTTGCGGGACGTCTAACTGAAAAATCATGAAGATGGTTAAGTTTACGCTATGTGTATATTTCACACAATTAGAAAAGGCACCCCAGTAAAGTTGGATAAATGTTGACAAATGTGCTACATCCATGTAACTGCCACTCCATTCAAAGTTAGAGCCGCATTGCCATGTCCCCAGAAAGTTTTCTCCCACACTTGCCACACAATCCCCTTACCTCCACCCCAGGCAAACCAAGATCGGATTCCGGTCACTGTGGGATTAGTTAGATTCTTCTAGAGTTTTACCAAAGCTGGAGTACAAGCATGCCCGCTTTTTGTCTTGCTTCTTTCTCTCAGCATAATTATTTTGTGATGTAATCATCCTGCCTGCATGGGATCAATAGTTTCTGCTTTTTTACTTGCTGGGGAAATGGTCTTGTATAGTATCCATCCACTGCAAGACCCAGACAGGCTATCCATGACATGTATCCACAGCGTTGTTTTCCATTGCAAGGCACCCACAAGTCCCATGCACTCTATTGGGGAGCCTACACATGGTGTCCATTGCAGGTACCCATACGTTTTCTCATGTATACACCTCCAACATCGTGTCCATGGCGGACACCACCATCTCCATCCACTGGTATAACACCTCCACATCGTGTCCATGGCGGACACCCACACATTCTCATCCACTGTTATACACCTCCACATCGTGCTCCATGGCGCGACACCCACACATCTTATCCACTGTATACACCTCCACATTCGTGTCCATGGCGGACACCCACACATCTTATCCACTGTATACACCTCACATCGTGTCCATGGCGGAACACCCACACATCTTATCCACTGTATACACCTCCACATCGTGTCCATGGCGGACACCCACACACCTTATCCACTGTATACACCTCCACATTCGTATCCATGGCGGACACCCACACATCTTATCCACTGTATTAACACCTCCAACATCGTGTCCAGGCGGACACCCACACATCTTATCACTGATACACCTCCACATTCGTATCCATGGTGGACACCCACACATAAAATTATCCACTGCGATACACCTCCACTTTCGTGTCCATGGTGGAACACCCACACATCTTATCCACTGTATTACACCTCCACATCGTGTCCATGGCGACACCCCACACATCTTATCCACTTGTATACACCTCCACATCGTTCCATTGGCGGACACCCACACATCTTATCCACTGGATAACACCTCCACATCGTATCCATGGCGGACACCCACACATCTTATCCATGGATACACTCACACATTTCGTGTTCCATGGCGGACACCCACACATTCTTATCCACTGGGCATACACCTCCACATCGTGTCGTGGCGGACACCCACACATCTTATCCACTGTAGACACCTCCACATTGTGTCCGTTGCATTGTAATTCTATTGGTATGGTGAACCACAGGCCATTTATTTATTAGCCTTTTGGTGTAGTTTTGCGTTTGATTTCCAGTGTGGCGGCTACAATGAATTACTCGCTTTGAAACATTCACCTACAGGTTTGTTGGGTGGACAACATTGCTTTCATTCTTGGCGTTAAATACCAGAGTGGAATTGGTTGGCGTTCCTATGGTATAAGTGTAGGTTTAACCTCAAGGGAATGCGAAATGATTTTGCTGAAATGGCTGCTGCCGTGGGACACTGAGTATCCAGTTTGTTCCACAACCTTGCCAGCACTTGGCATTGTCAATTGTTTTTCATTTTAGCCATCCTGAAGCGTTTCACGTTCATGTTCCTTTTCTTCTGCTTAAAATTTTGTTTAGGTTCAGGCATGATGGCTCACGCAACTGTAATCCAAGCACTTTGCGGAGGCTGCAGGTGGAAGGATTGCTTGAGCCCAGGAGTTTGAGACCAGCCTGCAATGCAATGAGACCCCATCTCTACAAAAATTAGCCTGAGTGTGGTGGTGCACACCTTGTCTCAGCTACTCAGGTAGCTGTGGTGGGAGGATGTTTGAGCCTGGGAGTTCAAGCTGCAGTGAGCCAAAATCAAACCACCGCACTCCAGGACTGGGTGACAGAGCAAGTAAAAAAAATTTTTTTAAACTTCTCAGCTGCAAATAAAAATCATGTATCATTATTGTGTGGCAACACGTATACACTGTAGAGCAGCTGTGATTTTTTCTTTTCTTTTCTGCCTTTGACCACGATCTCTGTTGGCCTTCCTGCTCATCTTTCACTTGGCCTCCCCTGCCTGCCCCGCCCAGCCAGGAAGGGAGTCTGAGTTGAGGCGGTGGGCTGGGTGTTTGCTGTGTCCAGCTTCCGTGCCATGAGCCTGGTGCTGCAGACATTAGCCTGTGTAGGGCATCGGTCCTGTGTCAGAGGCTCACTCCCGTCCGGAGCTGCAGAACTCACATGCATGAGGCTGACTCCTGGGACCTGAGACCAGCCACCGCCTCCTTGGCCAGGGGCCCCAGACACTGCCTAGGGGAGGCAGGCATGCAGCAGGACTAGAAAAGCGGAAGATTGGTAGATGGTCTGGCAGGTGACGGGAGGGGAGAGCCTTCAGAGGGAGTGCAAGGTGCACGTCCTGCCCCAGGCCCAGGGCTGGCCAGGCCACGGGATGTTCCCTTATCTCGTCCTCACCTGCCCAGGTGTGAGTTTACAGCTCCGTGATACAGAAGATAAGCCAGGCCTTGGAGTGGTTGATGTAAGCCCCATTTGGGCCTCCATGAAGGAGATGCTTATAGGAGGGAGAAAGAACGGTTGAAAGCCCAGCTTTTAAGGGCCCGTCCCAGGGCCCAGCTGGGCCAGCCCAGCGGGGTGCCAGGGGGACGCGGAAGTGAGGAGGTAGGGGGCAGCCGTCCTAATGCGCCGTCACTTCAGCCTGGGTGTCCTCCTAGTCACAGGGCAGCCCTGCCACGGTTTCACAGCTTGCGCCTGCAAGCCAGGCTCTGCTGCCCCTGCTCTGGTGGACGGAGGTGTGCAGGGGCAATCTTAGGGGAGCATGGGGGCGTCCCACTCCACGCATGTCTCGGTTGGGTGGAGTTTCTTGTGAGATAGTTTTCTTCTGCTTCTGTGGGCTCTTCTGAAAAAAAAAGCGGCGGGTGCCGGCCAGCGTGCACAGGTAGGATGAGGGTGGATGGGGATTTATGCACCTCTAGCTCTAAGTCTCCAACTCAGTTCTGCAAGCCACAGGTCAGGGTCAAGAAATGGCGGAGCCTTGCTCCAGGCCTGCAAGGTGAGTGGGCAAAGACTGGCAGCACACCAGTCTTAAACACTCAGGGGCTCCCGACGGCTCCCACAGCACTCCCTATGCCTCTGGGAGCACCACGGTGTGCAGCGGCACTGGGTTGCTCTCCGGGAACCAAGGCCCAGGTATGCATTAGGTCGGGACCCACAGGACTGAGCAGCTCCCGGTTCACAGAGGAACACCAGGCTTCCAGCCACATGCCTATGTGAGGCAGCCCCGGTGGACACGGGGACAGTGAGGGCCTCCTGTCCTTTACTGTGGCCAAGTTTACACCACCTTTGAAATGCCCTCGGAGTTCTGGCATCTGGGGTGGGGAGCTGCGTCAGTGCGGGGGACTGGGGGGCTTGTCTTCTGCGTGCCCTGGGCTCCCCCTCCCGGAGGGCCCTGTCAGAGGCCCCACCCCACGTTTGTTTCTCTTCTGTCACCCCAGAGGTGGGGAATTGTCTTTAAGCAACTGCTTTCATTCAGCTGATAATCTATCGCAGTTTCTCTTTTAAAAAGTTTAATCAGAGGACATCCCGGATGCCATCTGAGGTCTGATCAACCCGGTCACCAGCGTGCCCACATTGGCGGGCAGCGGGATTTCCAGCCCGGAGCACGGAAACTTGACGCTTCTCGACAGCCTGGAAATGTAGGATTTTCCGGTTCGGCTTGTTGTAACACTGAGCCCAGCTCCAGGGACCCTGTCTCCCTCTTCGCAGGCTCCCATGGGGGGCTGGGGGAGCCAGGCGGGGCTCCGGCAGCGGGTGAACTGCGCTCTGTGGGCTGCCTCCGCTCCCAACTGTTGCTTCTCTGCCCCTCCAGGAATTCTTCCAGAATTCCTCCCTCAACTCTCTGCCCTGCAGGTTGCAAGCAGGGGAGCCCGCCCCGGGCCAGCCCTTCCTCCGCCTCCCCCGCCACTCAGGAGCGCAAACGGGTTCTGCGCTATCTTGGCCCTCTGTCGCCTTGTTGCGAAATGTAATCCACAAAATGCCTTCGTTGGGTAACCTTATCCTGGGCAAGCCCGCGTCAGCATCTCGCGGCCCCGTGACAGCCAGGAACTTCGCAAGCATTGAGTAATAATGCAGACTTTCAAAAACCGAGGCTGGCAGAGGGAGGCGAGGGCGGGAATGAAAGGCGGTTGGCCTGTAATTGGGACATGTGAACTTCCTCGGCAGGAGGATTAGAGGAGAGACAGCCTTGCCGCCGAAGATTAGTTTCAATTAGACCGGGCTGGAGGCGGAAAGGCCGCGACTCGGCGAAAAAGATTAAAACAAGAAGGAGAACGTTTCCGCGGCGCAAGCTTTCCGGGCCTGCAGCAGGCGGCCGCAGACCCACTAATGGAAGGCAGAGCGTGCACCGCCGTTCGAAGACTCGGCTAATTGATTCGACGCTTGCTCTTTTGCTTCGTCTTCCCTGCCTCACCCGCGCCCGTGCCACTTTTCAGATACTCATTTGTGCCTAACCACTTTGGAGGGGGGGCCCTGGCCCCGGCTGTGCCTGCAGGTCAGGGGAGAGCTGGGCAGGGTGGGGCAGCCCGCCAGACACTGGCACCGTTGCCCCCACTTGCGGTTCCCATTTCTTAGGCCACAGGGCCATGGGTGGGACGACTGCAGTGCTGAGATTTCTGCAGCCTTGGCCGGTCCGTGCCGCAAGCCGTGACCTCGGAGGCTTTGCTGGATCTTCAAAGCGGGCTTTCAAATTGCAGGTTCTGGTGTGTGCCCCCACCTCACCTCCTGGGGCCAAGGCCTATGTCTTTCCTCCCTCCTTCCTTTCCTTCCTGGGACTCTGCCTCTGTAAACTTGAGAATAGTTTTCGTTAGCAAAAACTGTAGACAAATGCCTGCAAGTTGGAATGTTTCCATGAGCGGCAGTTCGCTTCTGAAATTTTCTGGGTCGCGGGCGGTGGCTGGCACCCCTTGGAGGTCAGAAGTAGCTTAAACACCAGGGGCTAAGGGCTGGGGATGGGGACTGCGCTGGGCCACAGTCCTCATCAGAGGCCTCACGCAGGAGGCCAGTCCCTCCCTCCCTCCGCCTTCCCCTTCTCTCCTTCTTTCTTCACTTCGACCGAGACCGGAGCTAGGGGTTCGGGGCCCCTCCGTCTCAGAACCTACCCTTCTTCTCTTTACCATTTCCGTGGGAGGTCAGGGAGTGAGATCCCTAGCCCACTCCAGGGAGGCAAGGGGCACAGAGAGGTGCGTGGAGCCTGACACGCCAGCCTGACCTCCTGCTTAGCCTCCCAGCTGCGGGGCCTATGCTGCAGGAGCTGCCGGATCCTGGCTGGAATTCCTCATCTTGTGACGTGGAGGTGGAGCCTGGCACTGCCCAGTGGATGCTGTTGCTCCTGTACCTGAGACAGTGGGAGGGCTGGTCCCCGCTCATGGGGCCACTGTCTTGTCCATGCAACCAGGCCCAAGCTCAGAAGCCCCGCGGGAGGTATCTGTGTGCTGCAGTGGACTCCATGCATGAGCGTCGGGGGCAGCACTGTGTCCCTGGTCTGGGAGCCAGAAGAGGCAGTCCGGGTGTGGCTTTGAGCACCTGGCCTGCCGTCTCACAGGCAGAAAACCAGCTGCCTCCCGGCCTCCTCCGCTGCTTCCCCCAGGCCCTCCAAGCACGAGGTTGTGTCTGATGTGTGTGTTTTATCAATCCTTCCATTGTAATGACAGCTAAATTATGAAAAATGCATTTTTCACAGCTGGCTGAGAAAAACCCATTAGCATTTAATCAAGCGATCCAGGCTCATTTGGGGATTCATAGGCCGAGTTTTGTTTGCCGTAAAAGTCACGGACGTGCTGAACAGTCGTTTAGTGGGTTCACTGGAAAAATGGGGCCGAATCATTTCTCTTCCACGCCGTGCTTCCTACCAAGGGACCACCTCCTGCCTGGGGTCCAGGCTGAGCTCAGTGCTGGGCCCCTGGTGGGTCACTGCAACCCTCACCCTGCTTGCTCAGGTGGCAAAGCCTCTGCTTTTCAGGGACCCACCCACAGCAAGGGCCCCTTGTATCAGGGGCAGGGGATGCCGTCTTGCTGACATTCGTGGCGGCTGGCTTGCGTTGTTGGTAAGGACGGGAGGCCCTCACTGTCCCGGCGTGTCCCACTGGGCTGTCAGCACTGGGCAAGTAGCCGGAGAGCCTGCGTGTCCTCTGTGGAAACCGCGGGGCCTGCCTCAGTCCCTGAGTCCCGACCTCATGCATGTCTGGGGCCGTGGTTCCCGAGAAGCCACCCAGTGCCCTGCACACCAGTGGGTGCTCTGAGATGCAAGCGAGTGCCTCGGGAGCGGTGGGACCCCAGGTGAAGTATCTAGATTGAGCTCTGACTTGCATTAAGTGATTTTTAACATAAATGTTTTATTTTGGAAGAATTTTGGATGAACAGAAGAAGCAATAAAGGGCATGTATAGAGAAGTCCACAGCCCTTTTTTAGGATTTTTTCCAAAAACCCCAACAACCCCAGGCTAGACACGAGAAACACATCCGACATAACCCAGGCTGGTGCTTCATCCAGGACCCTGGCCTCCTCCCGAAGACAGTCCTCCTGCCCCCATCCCAGGCTCCCTTGCTCACACCCTGTGCCCACGGGTGGAGATGCGCCAGGGCACACTGCACACCCTCGCTCCGGGCGCTGCTCTGGAATTCACCAGTTTCCACATCAACCATTCAGGAAGTGCCTAGGGAGGACACAGGCTGTGCTGCTGCCTTGGTGTTGGCCTCCCCACCCACCCGGACCCCAACCCTCTAAGTTCCAACACCAACAGGGCGTTTGCTCCCAGTCCTGGAATGGCCTGCCCCGCAGAAATCTCCCATCACACTGGCCTCTCTTCACCCAATCCATCCCTTAGGGTTCAGTTTAAAACCCCAACCTGCAGCGTCCCCACTGGCTCCCTGACCCCAAGAGTCTCGCCCCCCTTAGCACCCAAATTGTGCTTTTGTCCCCAACTCTCTCAGGGCATGAAACAAGTCTCTCCCATACCCCTGTTAAAAATCCACCCTGCCAAAACTATGGATATGTGTGCCTGCAAGGGTTTTGGTATACACATGGCTGTGTGCGCAGGTACATGTACCTTACACACATCGTGCCCAGGTATGCACAGACACGATACACACATTGTACCTGTGCACCACATATAATGTTATACAGCACCACGCATACGAATTGTATAATTGTATACAACACGCATGCAGACCTGTCAGTACACAGGGTAGTGTACATACGTTATGCACACCCCGGTTGATATGCACCCATGCTTTACCGTCGCTGTATCTGCTGAGGGCCCAGCGGGCGCCCCAGTGGCCATGCACACGCCCTGCACCAGATCCCATTTCTAACACCGTCCCAGTGAAGGGGCGGAGATCTGCAGAGAAGGGATGGTCTATGACAGGACAGGCGAAAATTCAAGATGAGCCTTGCATCTGTGGTCGCCAAGGAAATGAGGAAGAGTTGAGAAACAAAGCGATGCGGCAATAGATGGCCAAGGAATGCAGGAGCTGACCTGGAGGAGCTCCTGAGGCCACACTGGAAGGAAGGTGATCCACAAAAAGGGCAAGCATTGGGTTATAGCTCCAGAGATGAAAAAATACCCACCTGTCATGCGCCATAAAGTTAAATGAGGAAGGAAGGGAGGCGAGGGGAAGGGAGGAGAAAGGAGGAAGGAAGGAAGGAAGGAGAGGAAGAAAGGAAGGGGAGGGCAAGAAGGAAGGAAGCAGGGAGGAAGGAAGGCAGGAAAGGAGGAAGGAGGAAGGAAGGAAGAAAGGAAGAAGGAAAGAGGAAGGAAGAAAAGAGGAAAGAAAGGGGGAAAGGAAGGAAGGAGGAAGGAAGGAGGAAGGAGGAGGAGCGAAGTGAAAAAAGGAGGGAAAAAAGAAGGAAGAGAAAGGAAGAGGGTGGAAGGAGGAAGACAAGAGGGAGGAAGGAGGAGGAAAGAGGAGGAAGAAGAAGGCAAGGAGGAGGAAAAAAGAAGAGCAGAGAGGAAGGAAGGGAGAAGAGGAAGGAAGGAGGGAGGAAGAGGGAGGAAGGAGAGGAAGGCAGGGAGGAAGGAGGAGGAAGGAGGAGTAAGGACGGAGGAAGAGGAAGGAAGGAGGGCAGGAAGGAGGGAGGAAGAGGGAGGAAACAAAGGGGGGGCGAGGAGGAGGAAGAGGAAGGAAGGAGGAGGAAGGAGGGAGGATAGGAGGGAGGAAGGGGGAGAAGGAGGGAAGGAAGAGAGGGAGGAAGGAGGGAGAAGAGGAAGGAAGGAGGGAGGAAGAGAAGAAGGAGTGGAAGGAGGGAGGAACGAGGGAGGAACAAGGGGGGGAGGGGAGTAAGAGGAAGGAAGTGAGGGAGGAAGGAGGGAGGAAGGAGGGAGGAAGGAGGGGAGGAAGGATGGGAGGAACAAGGGGGGGAGGGAGGGAGGAAGAGGAAGGAAGGAGGAGGAAGGAGGGAGGAAGAGGAAGCACAGGGGGGAGGAGGGAGGAAGGAGGGAGTAAGGAGGGAGGAAGGAGGGAGGAAGGAGGAGGAAGGAGGGAGGAAAGAGGGAGGAAGGAGGGAAGAAGAGGAAGCGAACAAGGGGGGGAGGAGGGAAGGAAGGAGGGAGGGAAGAGGAGGAAGGAGGGAGGAAGGAGGGAGGAAGGAGGAGGGAAGGAGGGAGGAAGATGGAAGGAAGGAGGGAGGAAGGAGGGCGAGGGAAGAGGAAGGAAGGAGGGCAGGAAGGAGGGAGTAAGGAGGGAGGAAGGAGGGAGGAAGGAGGGAGGAGGAGGGAGGAAGGAGGGAGGAAGAGGAAGGAAGGAGGGAGGAAGAGGAAGGAAGGAGGGAGGAAGGAGGGAGGAAGACGGGAGAACAAAGGGGGGAGGAGGGAGAAGAGGGAAGAAGGAGGAGGAAGGAGGGAGGAAGTAGGGAGGAAGGAGGGAGGAAGTAGGGAGGGAACAAGGGGGGAGGAGGGAGGGAAGAGGAAGGGAAGGAGGGAGGAAGGAGGCTAGGCAAGGAGGATGAAGGAGGGAGGAAGGAGGGAGGAAAGGAGGGAGGAAGAGGGAAGGAAGGAGGCGAGGAAAGGAGGGAGGAAGAGTGAGGAACAAGGGGGAGAGGAGGAAGAGGAAGGAAAGGAGGGAGGAAGGAGGGAGGGAAGGAGGGAGGAAGGAGGAGGAAGAGGGGGAAGAGGGAGGAAGGAGGAGAAGAAGGGAGAACAAGGGGGGAGGAGGGAGGAAGAGGAAGGAAGGAGGGAGGAAGGAGGGAGGAAGGAGAGGATAGGAGGGAGGAAGGAGGAGGAAGGAGGGAGGAAGGAGGGAAGAAGAGGAAGGAACAAGGGGAGGAGGGATAGGAAGGAGGAGGAAGGAGGGATGAAGGGAGGGAGAAGGAGGGAGGAAGAGGGAGGAAGGAGGAGGGGAAGGAGGAGGTAAGGAGGGAGGAAGGACGGGAAGAAGAGGAAGGAAACAAGGGGGGGAGGAGAAGGAGGAGGAGGAAGAGGAAGGAAGGAGGAGGAAGGAGGGGGAAGCAGGAGGAAGGAGGAGGAAGGAGGAGGAAGGAGGAGGAAGGAGGAAGGAAGGAGTGAGGGAAGGAGGGGAAGGAGGGAGGAAAGGAAGGAAGGAGGGAGGAAGGAGGGAGGAGAGGGAGGAACAAGGGGGGAGGAGGGCAGGAAGAGGAGGAAGGAGGGAGGAAGGAGGGAGGAAGGACAGGGAGAAGAGGGAGGAACAAGGGGGGAGGAGGGAGTAAAGGAGGGAGTAAAGAGGAAGGAAGGAGGGAGGGAGGACAGAGGTAGGAAAGAAGGAAGCGAGGGGTAGGAGGAAGAAGGCACAGATGTGTTCTTGTTGAAACCCACAGGTGCAGGTACTCCCCCGTGGAAGAATGCACCTTAGCCCCCACCCACCGCCCCCAGTCACCTCCAGGGGTGCACCCCTGGCCGACTCCACCTTAGCCAGAGCCCACTCACTGTGGCTGCATCTCAGTGGGTTGCTGTTCCCACCCACGTCACAGACGGGACAGCTTCAGGGAGTCCTGAGGACAGCTGCCTGCCTTGGGGTCATTGAATTGCCATTTCTGACCCCTGGGCTCTGGCCTCAAGGCTTGGAGACAGTTTTTTTCCCATTTAAAACCTTGACTGGTAAAGACCTGTGACCTGGAAGTTCTCTGTGGTGGCGGCAGCTTGCCTGTTGGACTCCAGCCAACCTCTAGAGTCATGGTTTGGTGCCCCCCTGGAGGTTCAGCGAATGCCTAGACTCGGCAACAGGATGGGCCAGAGTCGGGGAGCCCCATGCAGTGTCCTGGCTCAGCCCCTGCCTCCTGGGTGGACGTTGGACAGCCGCTGGAGGTCTCAGCCTCTGTCTCTTCATCCATAAGGTGGAAATGACAAAAGCTGCACTTGGCCCCGAGGACACTACGGGGTTGCAGGGTCAGGCGGTCAGGGGTCGCAGAGCACTGCGGTCCCGTTGTATCAGGGCCCTGAGGAAGGGTGACAAAACTTTTCTTCATGCTCCGCATCACGATAACCAGCCTCAGTGGTGAAATGGAGTGAAGGCTTTTTGCCACCTCTGCTACTGGGGCCTCCACAAGGCTGATTTCTGCCGTCCACACATCTTGGGCCCAGGAAGGCCCCTAAGACAGTGAGTTTGTCCACGCCTCTTTGACCTCACCCACATAACTAGAGATGGGGGGTCTTTGGACTCCAAAAGGCCAACCTGACTGCCCTCCCCGGTCTCTGCCCCCAGCCCTAGGCCGGGGGCCAAAGGGGAGACCATGCCACACACAGCAGAGGTCTGCAAGCTTCAGGGGGACCCGCAGGGCTGGCAGGATAACCCCTCTGCTAAAAACCGCCTGGTGGCCGCTCTCCCGGGAATTCCTCTTCCTGGCGGGTCAGGCCGGCGACAGTCGGGAGGAGGTGCGCTGAAGGGCCCTCTTTTGCCATCGGCAACCATTTGCTTCCTGGTGAGCCCCACCAAGCCCGGGCGCCGCGCTCAGCATCCATGTGGACACCCCGGAGTGCCGATCATCCGTGGTGGGCGAGCCTCCTCCCGGTGACATCCCGGGAGAGCCACCACCCTCCCCATTGTCGGTGGCCAAGAGTGTAATCCTGAGGGTTTTGCTTCTTCCTCACTGATCTCTAAAAATTAAGCAAAAACAAACGCAGCAACACGTCACCGGGGCTTTCCCCGTTGCTGGGGACACCGCCGACAGCCAAGGTCTTGCCCATCCCTGGCCTGTCCAGCAAACCTGGCTTCCCTTTGCCTCTGTGCTGCTTCCCTTCTGGCCTGGAAGACCTGGGGCGCCGCCATGCTTGGTCGCCGGCGCTGTTTCCCTCCCCTCCAGGACACTTGCGGAACAGGTGGATTCAGAGGCTGAGCCAGGGCCCCGTCTCCCCCAGGCAGCTGGCAGAAGGGAGTTCTCTGGGCGTCAGAGAAGCCTCCTCCCTGCCTTGGTGGGGCCGACTCTGTGGTTGCATTGAGAGTGGTCCAGCGGGGCGTGGGGGCTGCGTGGGAGGCCAGGAGTTGCAATAGAACCCACAACCTGTGGGCAGGACTCTCTGAGGAGGAGCAAACCCAGGGAGAGGACCACAGGGCGTGGGGGGCTGGGAAGCACTCACCAGGGAAGCCCTTCAGTCCCAGGCACATCTCTTGGAGCGGGTTTCCCTGAAAGACCGGCCTGTGTGGTCCCAGCCTTGCACTCACAGACATGCCTTGGCCAATGAGAGAACGCCCCACTCTTCTGGAGCCGCGCCCCAGGCCCCAGCAGGCTCCTCTCAGGGCAGAACGGTCACTTGCTGTGGGTTCTGTCTCTGGGGGGCCCTCCTTGGCGCCAAACACATCTGGCTTTTTTCCTAAAGTCAGCACCGCCAGAGCCGGGCCAAGTTTAGGAACTGCCCCGTCCCTTCAAGGAGCTGGCAGAAGGAGCCTCTGGGGGTCAGAGAAGCCTTCCTGGCTTTGGTGGGGTCATGGAAGAGCCTGTTCAACTGCCCATGGCCATTCCAGCAGGCCCTTGGCACAGCCTCTGCAAGGGAGCAGCCTCACCTGGTTCAACCAGAGACCAGGCATCTCTGCCCTGCAGGCGGGCCCTGTCCTCAGACCTGCCACGTTTACCACTCTCCCTGCGAAAAGGCCTGTGGAGCTGGGAGTGTGCAGAGAGGTGGACCCAATGAAAAAACCCACCCGTGCCAAACCAAAGACCCTTCCTTGCTCCTTGGAGCGACAGTTTTTTTCCCAATTTATAAACCTCAGATTCCAGGAAGGGAACTGAGCCTCCCGCCTGCGGCCCCCAGGAGGAGCTCGTTGCTCAGGAGGTGCCCGGACCCTGGAGCGTGGAGCCAGGGATAGGCCTCTGGCATCTGGGCACTGGGCCGGAGGGTGGATAACCCAGCCTGCAGACAGACCTGCTCCCGGCTACGGTCGCCAGTGCATATCTGGACTCCGTTTTGCCCTACTCAGGGCTGGCAGTGACTCGACTGAACGCAGCCAGTCTCTGAAGGGCCGGTTGTGCTGATTTCTTTATGAGGTGGAAAGCGCAGAGTCCCCCTCTGGATTCACACACCTGGGGAGGCGTCCTGAGTGGACTCCTCGGTCCAGAGCCCGGTGAGCACTGGCACAATGGTAGGGCAACAGCACTGCCTCCTGAGTGAGCTGGACCGGAAGCCTGTGTCATCTGTTAAATTAGTGTGAGCATCCAAGGGAGGCTGATCAGGGTTTCAGAGATTCCTGCTCACTGGGGGGCTGAACGAACCGTCAGGCTCTGAGCTGCAAACTTGCAGAAGGCGCACTCAGGGCCGTTGATCAATTTGTTAGCGATAGCCGCCATAAATACTCTGATTTCCCCATCTGGCTGGACAGCTCCGCAGGGCGCTGACGTTAAACTAATTGCCCGTTGGTGGGAGGCTGTTGCGGACGGGGCCCCCGCCTCTCACACCTTGCCGCGCTTCCTGGATAGCGGTGATAGGGATCGGCTCCATCCACGGGCCCCACAAGGTACTTCAGCAGATGGGTGAGACCAAAGGCTCTTGGGGGGTTTTTATGTCAACTCGGTCCCACTGACCTTTTGGGTCACAAGAGGGGCGTCACCAATAAAGGGCCGCTGCAGTCCCAGAGTCTCTTGGAGGTTAAAGCCCTCAGCACTTCCCTGGGGGGGGGGAAACAGCAAGCTGACCCTGGCAGCTGGAAACACTCAGCCAACCTCTTCCAGGGAGTCCCCCAGTGACCACTCACCCAAACCCCAGACACGAGAGGAAGATTTTAAGGGGAGTCCGAGATGCTGGCTTCCAACCAGGCAGAGGGCACCTCCCCCGTCATCGGGAGCCCAGCCCAGGAACGGCCACACCTGGGCGAGCTGGGGGTCTGTCCCTTGGGGCAACCTCCAACCTCCCAGCTTCTCCGTGGCCTCTCAGTATTGCTGGGAAATGAAAAAGGCTTGAAACAGCGGAGAGGCCAAGAAACCCCGCCCCGAGGGGCCTCAGTCGCCTTGCATCCCAGGGGAGAACCAGGAGAGGACAGAGTGCATCTGATCTGGGCTGCTGGTCATTGGGGGGTTGGCTGGCCATGGGGGTGCCTGGTCATAGGGGCTGCTTGGCCCATGGGGGTGCTGCCCATGGTGGTGCTGGTCATAGGGCTGCTGGGCCATGAGGGTTCCTGGCCAATGGGGAGTGCTAGCCTACGGACGGGTGGTGGCCACGGGGGGTGGTGGGCCATAGGGGTGCTGGCCACGGGAGGGTGCTGGGCACTAGAGGGCTCTGGCATGAGGGGTCCTGGCCATGGGGGGTCCTGGCCATGCGAGTGCTGGCCACGGGGGGGTGGTGGCTATGGTGGGTGCTGGCCACCGCTTTAGGGGCACTGGCGGCCAAGGGGCGAAGCCCGGAGGCCTCAGCCAGGCACATTCACCCCAAATCCCACAATCCCATGAGGAGTCCGTGAGGCATTCCTGAGCGAGGACCCTGCTTCCTTCAGTCCCTTAGAACCCTTGGGGAGGCCGGTCCTGGGAAGCCAGGCCCAGCTGCAGATGCGGGGTACCCTCAGGCCTGGGTGGGATCGAAGAAGGCCACACCACATGGCCGGCTGCATTCCAGAAGCCCCAGTCCATGTGGTGGGTCTGAGAAGTAAATGCTGACTTTGAAGGGCACAAGTATTTAGGAAGCTGCAGGTCCGGCGGCCACCCCGGTTGGTGTTCCTCGGTGCCAGTGGGACGGCCCCTCGACAGCTTAGTTGCGGCTCTACTTTCAGGTGGGCGGAACCCCTGGGGTCTTTTCCTGACCCCCCACCCCCACTCCCTCCGGGCAGGGCCGGCTCTCGGGGGCGGCTGACTCCAGCCTCTGCTTCTCCCGAATTAAGACGGATGGCGCTTCTCTAAGAAAGGAAATGTATATCAACAAACTTCCATCCCGGAGATCAAACCGCTTCCTCCCGCCGCTCCCCAGACACCTCCGTGGCTGCCCCCCCTCGCCCACCCCACCCCCCAGGTCCTGCTGGCCTTCCCTGGCCCATGTGCCGGCTCGGGCGACCTCAGGAGGGGGTGGTGGGGGTTGCCTTGCATCGAAGCAACAGTAGTCCACTGCCCCGTGTGAGGCTGAGCTGGGCTGGCCAGAGCAGGGCCAAGGGGCCCTCTGCACTTTCAAATATCATTAGAGTCAGCGGGCTCCCGCAAGCGCCAGAGGAGCCCTGGGGGGAAGCCCCTGTCCATGGCTTCCCAGTGCCACCAGGTCAACGGCCGTTTCCTATCAGGGGATCTAAAATCCCTCCCCCAGGAAATGGCCTGGCCAGGGAGGGGGACTGGGAATTCCGAGCTCCTGTCCCGGCTGTGGTCTTATTTGAGATGGCATTAAGCCCCGGGTAGCATCGCCTCCGGAGCGAGCGAGGTGGTTTGGGGGGCGATTGGGCGGCTACAGCGTGGCTGGCAGCCTCCTCCCATTGCCCCTCACCCCTGGGTGGGAAGCCACCAGCTCTCAGAGCAGTTGGTTATCCCTGGCCAGCAGCACTGGGTTTAAAAAAGCCAGAGAGTGTGGCGATGGGGAAGATCCAGCCACCCACCCGGCCTGCTGAACCGCTCCAACCACCTTTTCAGGGAGACGGCTGCTGTTGTGCGCAGGGCTCCCCAGGCAAAGCTTGGGGTGGGGCACCAGCAGGGGCTCTGGATGGGGCATCCTGGAGGGCGGAGCCTGGCGTCAGGGGCTGACGTGCGCCCAGTTCACGCCTTGTCTAGGGCCTCCCTGGGACGGTGCCAGTGCTTGGCAGGAACAGACCCTCCGTGCGCCCTCTTTCTGGAATTGGCCGCTTCCCCTCGAGACTCAGAGCCCCATGAGGACTGTGGGGGGACACGCAAGTCTGTGCTGGGGGAGAAGCTCGTGGACCTCCTGGGAAAGCTGGAGTTAACATACCGAGCCAGGCCGGTGGGCTCCATGGGCCAAGAGACCCCCACAAAAAGCCTGCCTCTAGCCGTGCACCTCTGCTCGGGCTCCCGGGAGGCAGAGCCGGATTTCCAGCTCCCCCCCAGGATAATGCTTGCGGGGCATCATTGTGGCTCAGACCCCTGGAGCTTGTGTTCAGAGGGCAAGGTGCTTCCTGGCTCCAACCACTGTTCACACAGGGTGGGGTCTTGCAGCTTCCCCTTCTGAGAGGCTCTGGCCTGGCAGGGTTGAGGTCCCTGACTGAGGACAGGAAAGAACGGGGGGACCGTGCGCACTTCGCCTCTGACCAGCGCTGGTGGCAGCTGTGTCCACAGAAGCCTCCGCAGGAGGATTTCTCACAGCCCAGCCCAGCCGTGAGAGAGAGCCGAAGGCCTTCAAGGACAGTGACGCGTCCAGGACCCTATGGGGCCAGTGCCAGCCAAGCCTTCAAGCAGCTGTGCCTGCCCTTGCACTGCGTTTGCCTTTCAAGCAAGGGAAGGTGGTAGGTGCAACTGTGCTCTGAGGATGAGCAAGGATGAGAGAGGGGACCCGAGACAGAGACAGAGAGTTGAAAGGGGGAAGGGGAGGTGCCGTAGAGATGGAGGTTCTGAGACCTCACTCAGGGCATGGCCTAGGTGCTGAGGCGTTCTCCTGGCAGCTCTGGGTCTGAGACCCTGGACGAGGGCTGGCCTAGAGAGAGCAGCTACTGCAGAAAGGCTGAACTCCTGGGGAATCTGGCTGCCCAGGGGCCTGAGAGGGTGAGGTGGGGCGACTATCCAGAGGCCTCATCCTGCTCCCTTTCCTGCGGCCTTCAGTCCGGCCGTCTGGGTGCTGTGCAGGATGGGCTGGCTCTGAAACAGTGATCACCGCGCCACGCCACGGGGCAGCCTTCTGGTGGAAAACCAGGCGTTTCCCTGCAAGCCAGGGCTGTGCCAGAGGCTCTGGGATCAACTGGTTCAGGCCCCACGTGCTTGAGCGGACCTGCATTCTCACTGCATAGGGATACTTGGGTCCTGGAGCGTGAAGCACTCTCCTGAGACCCCCGCCCCAAGCTGGGCAGCCTCTGAGCGTCCGCACCCTATCCCACACGCGGTGACATGGAAGGGGCCCTGCGTGCTGGCTTGGGACACACTCCCTGACCTGCAGGGGCCCCAATACCCAGCACTTCACTCACACCGCGTTCCCATCCTGCAGGCTGCGCACCCAGAGAGGATGCGGCTTGCGGCCCTGTGCAGAGGGGAAGACAGTGGCTCAGGGACACCAGCCACAATGCCAGGGATGGTTCTGCGCCGAGTGGGGCCCTCCATGGGGGCTTGGAGCACCCCCCATCCGGGCTTGGCCAAGCGCTGCCTGGCCTGAAGGTTGACGGAAATTAGCTCAGCAGCCCTGCCCGGCCAGGCGTCCTCGCCCCTTCTACGCTGGAAAGAGGCGGCAAGCTGTGTTTATTTAGACTCCCTCAAGCTGACAGCTTGGAATCAGGCTAATTTACCTGAAGTAACACCAACCGTCTCTCTATTTATTTTTACGATATTTCACCAGCGTAACCAATCCCCACCCCTCACCGCCTGTTTACCGTGGCCCAGGACAGCCGCATCTGTCCCTCATAGCCCTCGGCTGCTGCCCTGCCTTTTCAAGGACGGCAAAGACGTTTCGAACGGGGGCGCCCGGGGGGCAAAAGGCTGGGCTTGAGGACAGCATGGGCGGCACCCGGAGCCTTCGGGACTCAGGGTGTGGAGTGGCCGTGTGCAGTACGTGCCCACAGGGCTGGGTGAGGCCTCAGGGTGAATGGCCGGAGGGGGCCTTGCACCTGCACGAGGATTCTCCTCACCTGGCAGGGGAGAGGAGCTGCTGGCGCCCAGCCCAGCAAGGAAAGCAAGGAGGCGCCCACTTTGACCCCAGGCGGCACATGCCGCCTACTCAGGTTCCCTCACGCTCGGCCCGCGAAGAACCATGACCCACTTTTGCAGAAAGGAAAGACCTGCGGACCTGGAGTCACTCACCCAGCCGGCCATCCAGGAAGCCCGGCTCTTCCCAGGGAGCGTGCTGCCCAGGCTCAGCGCATGGGCCAGGCAGGCTGGACAAGTTTACCCCAGCGGACAGGCTGGGGCTGGCTGGAGCAGAGAACACCCTGGCCCAGCGAAAGAATCCACAAGCCACAAGAGAGGCCGTGCCTTCTGTCCCTAGGAACAACTCGACAGAGGCAGAGACCACGCCACCACAGGTATGGGGTTTTGGCTATTAATCCTGACAGAAGAAGAAGCTGGAATGGCTGTGTGCCACCTGAGGGAACCGCTTGCTGAGCCTTTGCTGGTCCAGGGGCTCGGGCATCAAGCAGGACTCCAGGCGGCCACCCAGAGGGCCATGCTGTGCGCGGGACTGGGTGTTGGGCCTTCAAGCGTTGACAAACACCTCTAGAGTGGGCTCTGTGCTGGTGCCAGTTTCCCTGGTCCGAGGGTTCCTGCGGCCACCAAGGAAAGCCCTGCCCCAGCTTGCGTGGGAGCTGCCCGGCCAGGCTAACCACAAAAACTCGCAAAAGACAAGTGACAAATACCTTTGAGAGAGGTTGGAGAAAGCAAAACTGAAATAAGGGGCCCAGATGAAGGGTGTTCCGTGCGGCAGTTAGGAAGGGCTTCCTGGAGGGAGGTGAATTTGGTGCTGAGGTTGGAATGCTGAGGCTGAGCCTCCACAGGAGGTCTGGGCAGGAGTCCTGGCAGAGGGCGGCCTGTACAAGGCTCGTGGCGGTCGAGGGAGCTTAATCCTGAAGCATGGTTGGGCTGGAGTGACCAGAGAGCTCCGAGGGCTTGTTGGGAAGGTGAAGGCCACGCAGGACCTGGTGCTCACAGAGCCGGGGGCAAACATGCGACCAGCCCAGCTTCTCCCAGTGCCCTCCAACGCCCTGGGCAGGGAGGAAGCGCATCAGTGATGTCATCCATCATTCCTGTTCAGGATGTACTGGGCGTTACGGGCAATTGTAAATTAGATTTCTACCACCATCCAAAAGTGCCTCCAGGACGTTTTCTTTTCCTGAAGTTGTTAACAACAGGACAAACTCTAGAGTTGCTGCTCCCCTCTGCCCTGGATCCGTGGCCATGACAGGGTGGCTGTCTCTGCAGCGGGTTTGGTCACCTGCAGGACAGGGGCCCAGCCTGCCCGTGGGGTCCCCTGCCTCCCTCCAGCCCCTCCACTCCCCTAAGCCCCAGCCTCCTGGCCAGGGCGGAAGGCAGCCTCTCTTTTCTCACACCCTGGGTGCCTCAAGGGGCAGTGCTCACCCCGAGCTAGGGGCTTTGTGGCCCCCGGCCCTGGGGGCTGATTTGGAGGTGAGAGCGCCTCAGTGCCTCTCAGATTCCCAAGAAGGAGGGCCAGTGGCCTCCACCATCCCGGCCTGCAGCCCCAGGGCCACTATGGTGCTGCCTGCCTGCGGGCATCGTACGGAGGCCAAGGGTTTCAGGGGCCTTTGGCCTCTTGCCCTGCAAGAACGTGAGCGAGCCATTCCCTGATGTGGGGCAGAGGCGGCGAGGTGAGGGGAAGGTGGAGCCAGGCTGGGTCCAGGCAGGCAGGCACCAGGGGTCAGTGAGGGTGGGCCGGCCCGGGGGGATGCCCTGTCGCCCGTCTGCAGTGCCAGCTCTTCTCCTGCACGCCTCCCTCCCGGACGCCATGCGCCTTGCTGCGGGCCATACGTCTCTGTCAAAATCTCTATGAATAAATTAAACCTTTTTAAAGATTAGTGCTCTCTAATACCTCAGGGTTTTTTTAAACACAGCAAATGCTACAAATATTTTGCGAGCATGGCTGGCGTTTGCAGCGGCTATGCCGTCAGCAAGGCCCCACCAGCGTCCCTCCATGGGCCGGCCCTGCCAGCTGACCTCCACCAGGCTGCCCTGACACTCCAGGAGCAGGTTTTCCGGCCCCCATGGGGAGCAGCATCGCCCTGTGGGGCGGAAAGTTGAGGGGACGTCCACCGCCAACAGGAGGCAGGAGGGCGTGGCTGTGCCACGGCAGAGATGTCCCGTTTGCTGCTGGCCTCTTCCTCTGAGTCTTTGTTGCACAAGATGGGCTGGGCAGTCACAGTCCCTGTGAGCTGTCCACGAAGCCACCTGACTCCTGGGGTCAGATGGGGGCTGGCACTTTCTGTCATCCCACCTCGGTGCGCCTTCCTCTGTCAGCCAAAGGGCGCGGTGGAAGCAGTGTGAAGGCGGTGGCAGGGGGTTTTACAGTCAGGGCTGCGGCTTTCTCCTCAGTGGTTGAGGAAGGTGGGCGACCCAGGCAGGGGTTTGAGGTGCAGGAAGGCAGGAAGTTGAGAAACAACGGCTTTTGGGGGCCGTCGAGGTTGGGGGACTCTGTGTGTGGACAGAGGGCGTCGGTGGAGCTCAGAGGGGGGGGTCTCTGGCAGGGAGAGAACAGGCTGCAGGGGCTGCTCCCTGGGGTGCCCGGCTGCAGGTGGAGGAGTGGGGCTCTTGTCCTTGGCCCAAGGAGCCACTGAAGGCTGTGAAGGAAAGAGCGTTGATGTCACAGAGCTGGGACAAGGGCCCCCAGAGAGCAGGATGGAGTGGGGTGTGTGTGGGGCTATTTCCAACAGGCCCGGTGGAGGCATGAGGACCAGATTGGGAGCACCATGAGGGGGAGGAAGGGGGCCCAGCACCCCCCGAGGCCCTCTTCTCAGGACAAAGTTCACCCTCTGAACCCACTCCAAGTGGTTCACTCCCGAGGGCTGGGCTTGGCCACGGCTGCGTCCCCAGCATCCCAGAGCCTGGCCTGGCACGGGCAGGAGCTGAAGAGCTCACACCTGGGGATGTGGGTCCAACATTGTCCCTGGAGCCCCGGGCCTCCCTCTGGCCTAAATCAGCTCACTTTCCTGGGGAGCGGGCGGGACTCCCGCAGCGTCCCAAGTTTCCCAGCGGCCTCCCACAGGCCCCAAGGGACGCAGTTGTTATCTTCACTTGCTCAGGGGACCCAGGAGGGAGCTACCGCCGGGGACCTCACCTGCCACGAGCCTCCCCTCACGTGTCGGTTTCAGAACTGTCCAGCTCTCCCTGCAGGAGCAGGCAGCCTGCGACCCCCGCCCAGAGGCCCTTGCCACCAGCGAGGGTCTCGTGTCAGGTGGGCGGCTCAAGGGAGCTGTGCGGGTGCTGGCGGTCTTTCTCCTCGTCC'
testseq = testseq[:2000]
pstring = sys.argv
forvaule = False
pdict = {}
command = 'vacmap'
for item in pstring[1:]:
    command += ' ' + item
    if(forvaule == True):
        forvaule = False
        if(op == 'outputdir'):
            if(item[-1] != '/'):
                pdict[op] = (item+'/') 
            else:
                pdict[op] = (item)
            continue
        try:
            pdict[op] = eval(item)
        except:
            pdict[op] = (item)
        
    if('-' == item[:1]):
        forvaule = True
        op = item[1:]

print(pdict)
hit = False
if('ref' not in pdict):
    print('reference path is required.')
    hit = True
else:
    if(os.path.isfile(pdict['ref']) == False):
        print('reference file not find')
        hit = True
if('read' not in pdict):
    print('read path is required.')
    hit = True
else:
    if(os.path.isfile(pdict['read']) == False):
        print('read file not find')
        hit = True
if('outputdir' not in pdict):
    print('outputdir is required.')
    hit = True
else:
    if(os.path.isdir(pdict['outputdir']) == False):
        print('outputdir not find')
        os.mkdir(pdict['outputdir'])
        print('outputdir created')

if('mode' not in pdict):
    print('mode is required.')
    hit = True
else:
    if(pdict['mode'] not in ('H', 'L', 'S', 'asm')):
        print('Invaild mode '+ pdict['mode'])
        hit = True
if('maxworker' not in pdict):
    print('maxworker is required.')
    hit = True


if(hit == True):
    print('Usage')
    print('python mammap.py -ref /ref.fasta -read /read.fasta -outputdir /outputdir -mode S or H or L -maxworker number of threads')
    print('\t-mode H ')
    print('\t\tFor aligning high error rate long read.(Pacbio CLR, ONT)')
    print('\t-mode L')
    print('\t\tFor aligning low error rate long read.(Pacbio CCS)')
    print('\t-mode S')
    print('\t\tBest for complex structural variation discoverary')

else:
    H = False
    if(pdict['mode'] == 'H'):
        import vacmap.mammap_clrnano as mammap
    elif(pdict['mode'] == 'L'):
        import vacmap.mammap_ccs as mammap
    elif(pdict['mode'] == 'S'):
        H = True 
        import vacmap.mammap_ccs as mammap
    elif(pdict['mode'] == 'asm'):
        import vacmap.mammap_ccs as mammap
        
                    
    refpath = pdict['ref']
    if((os.path.isfile(refpath+"_w10_k15.mmi") == False)):
        if(('mmi' != refpath[-3:])):
            print("Using minimap2 to build reference index")
            print()
            import subprocess
            subprocess.run(["minimap2", "-d", refpath+"_w10_k15.mmi", refpath, "-w", "10", "-k", "15"]) 
            refpath = refpath+"_w10_k15.mmi"
            if(os.path.isfile(refpath) == False):
                print("Failed to build reference index")
                hit = True
    else:
        refpath = refpath+"_w10_k15.mmi"
    pdict['ref'] = refpath


    refpath = pdict['ref']
    prefix = pdict['outputdir']
    readpath = pdict['read']
    max_worker = pdict['maxworker']

    index_object = mp.Aligner(refpath, k = 15, w = 10)  # load index

    if not index_object: raise Exception("ERROR: failed to load index")
    contig2start = Dict()
    contig2seq = Dict()
    index2contig = List()
    contig2iloc = dict()
    header = dict()
    header['HD'] = {'VN': '1.0'}
    header['SQ'] = []
    iloc = -1
    for item in index_object.seq_offset:
        iloc += 1
        contig2start[item[0].decode()] = item[2]
        contig2seq[item[0].decode()] = index_object.seq(item[0].decode())
        index2contig.append(item[0].decode())
        header['SQ'].append({'LN': len(index_object.seq(item[0].decode())), 'SN': item[0].decode()})
        contig2iloc[item[0].decode()] = iloc
    header['PG'] = [{'ID': 'VACmap', 'PN': 'VACmap', 'VN': '1.0', 'CL': command}] 


    rc_testseq = str(Seq(testseq).reverse_complement())
    testseq_len = len(testseq)
    setting_kmersize = 9
    readid = 'hhk'
    st = time.time()
    onemapinfolist, (alignment_list,raw_alignment_list), one_mapinfo, f_redo_ratio = mammap.get_readmap_DP_test(readid, str(Seq(testseq).reverse_complement()),  contig2start, contig2seq, index_object, index2contig, hastra = True, refine = True, debug = False, H = H)  
    print(f_redo_ratio)

    




    n = max_worker

    raw_queue, cooked_queue = multiprocessing.Queue(maxsize=1000), multiprocessing.Queue(maxsize=1000)
    for count in range(1, n+1):
        savepath = prefix+str(count)
        print(savepath)
        if(pdict['mode'] != 'asm'):
            multiprocessing.Process(target=mammap.get_list_of_readmap, args=(raw_queue, savepath,  index_object, contig2seq, True, H, header)).start()
        else:
            multiprocessing.Process(target=mammap.get_list_of_readmap_asm_1, args=(raw_queue, savepath,  index_object, contig2seq, True, H, header)).start()
    st = time.time()
    count = 0
    unique_set = set()
    for fastapath in [readpath]:
        if('bam' == readpath[-3:]):
            print('read bam')
            bamfile = pysam.AlignmentFile(readpath,'rb')
            for rec in bamfile:

                name = rec.query_name
                seq = rec.query_sequence
                if(type(seq) != str):
                    continue
                if(rec.is_reverse == True):
                    seq = str(Seq(seq).reverse_complement())
                if(hash(name) in unique_set):
                    continue
                unique_set.add(hash(name))
                count += 1


                if(raw_queue.full() == False):
                    raw_queue.put((name, seq, None))
                else:
                    time.sleep(1)
                if(count%100000 == 0):
                    print(count, time.time() - st)
        else:
            for rec in mp.fastx_read(fastapath):

                name = rec[0]
                if(hash(name) in unique_set):
                    continue
                unique_set.add(hash(name))
                seq = rec[1]
                count += 1


                if(raw_queue.full() == False):
                    raw_queue.put((name, seq, rec[2]))
                else:
                    time.sleep(1)
                if(count%100000 == 0):
                    print(count, time.time() - st)

    for i in range(n):
        raw_queue.put(i)
    while(len(multiprocessing.active_children())>0):
        time.sleep(1)
    print('Finshed')
